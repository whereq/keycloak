{"version":3,"file":"PermissionSelect.js","names":["React","Select","SelectOption","SelectVariant","Msg","ScopeValue","constructor","value","_defineProperty","toString","displayName","name","compareTo","selectOption","PermissionSelect","Component","props","event","selected","state","onSelect","includes","setState","prevState","filter","item","map","sv","isExpanded","values","s","scopes","option","index","createElement","key","find","render","titleId","id","hidden","msgKey","maxHeight","direction","variant","typeaheadMulti","typeAheadAriaLabel","localize","onToggle","onClear","clearSelection","selections","isOpen","placeholderText","menuAppendTo"],"sources":["../../../src/app/content/my-resources-page/PermissionSelect.tsx"],"sourcesContent":["import * as React from 'react';\r\n\r\nimport { Select, SelectOption, SelectVariant, SelectOptionObject } from '@patternfly/react-core';\r\nimport { Scope } from './resource-model';\r\nimport { Msg } from '../../widgets/Msg';\r\n\r\ninterface PermissionSelectState {\r\n  selected: ScopeValue[];\r\n  isExpanded: boolean;\r\n  scopes: JSX.Element[];\r\n}\r\n\r\ninterface PermissionSelectProps {\r\n  scopes: Scope[];\r\n  selected?: Scope[];\r\n  direction?: 'up' | 'down';\r\n  onSelect: (selected: Scope[]) => void;\r\n}\r\n\r\nclass ScopeValue implements SelectOptionObject {\r\n  value: Scope;\r\n  constructor(value: Scope) {\r\n    this.value = value;\r\n  }\r\n\r\n  toString() {\r\n    return this.value.displayName ? this.value.displayName : this.value.name;\r\n  }\r\n\r\n  compareTo(selectOption: Scope): boolean {\r\n    return selectOption.name === this.value.name;\r\n  }\r\n}\r\n\r\nexport class PermissionSelect extends React.Component<PermissionSelectProps, PermissionSelectState> {\r\n  constructor(props: PermissionSelectProps) {\r\n    super(props);\r\n\r\n    let values: ScopeValue[] = [];\r\n    if (this.props.selected) {\r\n      values = this.props.selected!.map(s => new ScopeValue(s))\r\n    }\r\n\r\n    this.state = {\r\n      isExpanded: false,\r\n      selected: values,\r\n      scopes: this.props.scopes.map((option, index) => (\r\n        <SelectOption key={index} value={values.find(s => s.compareTo(option)) || new ScopeValue(option)} />\r\n      ))\r\n    };\r\n  }\r\n\r\n  private onSelect = (event: React.MouseEvent | React.ChangeEvent, value: string | SelectOptionObject): void => {\r\n    const { selected } = this.state;\r\n    const { onSelect } = this.props;\r\n\r\n    if (!(value instanceof ScopeValue)) {\r\n      return;\r\n    }\r\n\r\n    if (selected.includes(value)) {\r\n      this.setState(\r\n        prevState => ({ selected: prevState.selected.filter(item => item !== value) }),\r\n        () => onSelect(this.state.selected.map(sv => sv.value))\r\n      );\r\n    } else {\r\n      this.setState(\r\n        prevState => ({ selected: [...prevState.selected, value] }),\r\n        () => onSelect(this.state.selected.map(sv => sv.value))\r\n      );\r\n    }\r\n  }\r\n\r\n  private onToggle = (isExpanded: boolean) => {\r\n    this.setState({\r\n      isExpanded\r\n    });\r\n  }\r\n\r\n  private clearSelection = () => {\r\n    this.setState({\r\n      selected: [],\r\n      isExpanded: false\r\n    });\r\n    this.props.onSelect([]);\r\n  };\r\n\r\n  render() {\r\n    const { isExpanded, selected } = this.state;\r\n    const titleId = 'permission-id';\r\n\r\n    return (\r\n      <div>\r\n        <span id={titleId} hidden>\r\n          <Msg msgKey='selectPermissions' />\r\n        </span>\r\n        <Select\r\n          maxHeight={300}\r\n          direction={this.props.direction || 'down'}\r\n          variant={SelectVariant.typeaheadMulti}\r\n          typeAheadAriaLabel={Msg.localize(\"selectPermissions\")}\r\n          onToggle={this.onToggle}\r\n          onSelect={this.onSelect}\r\n          onClear={this.clearSelection}\r\n          selections={selected}\r\n          isOpen={isExpanded}\r\n          aria-labelledby={titleId}\r\n          placeholderText={Msg.localize(\"selectPermissions\")}\r\n          menuAppendTo=\"parent\"\r\n        >\r\n          {this.state.scopes}\r\n        </Select>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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"}